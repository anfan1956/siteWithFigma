{% extends 'base.html' %} {% block content %}
<link rel="stylesheet" href="{{url_for('static', filename='/css/catalog.css')}}"> {{ super() }}


<div class="cat-wrapper">
    <div class="scrolling-header">
        <button class="category" type="button">some text</button>
        <button class="category" type="button">some long text</button>
        <button class="category" type="button">some text</button>
        <button class="category" type="button">some long text</button>
        <button class="category" type="button">some text</button>
        <button class="category" type="button">some long text</button>
        <button class="category" type="button">some text</button>
        <button class="category" type="button">some text</button>
        <button class="category" type="button">some text</button>
        <button class="category" type="button">some text</button>
        <button class="category" type="button">some text</button>
    </div>
</div>
<!-- <div id="loading">Загрузка...</div> -->
<div id="loading"></div>


<div class="white-wrapper">
    <div id="ticker"></div>
</div>


<div class="products">
    {% for s in styles %}
    <div class="product">
        <a href="/product/{{s.модель}}"><img data-src="/imagesDir/{{s.модель}}/540/{{s.фото}}" class="lazy" alt=""></a>
        <div class="product-info">
            {% if s.промо_скидка != 0 %}
            <div class="promo"><span class="purple">промо: {{ "{:,.0%}".format(s.промо_скидка) }}</span> </div>
            {% endif %} {%if s.скидка != 0 %}
            <div class="discount"><span class="red">
                    скидка: {{ "{:,.0%}".format(s.скидка) }}
                </span></div>
            {% endif %}
            <div class="brand">{{s.бренд}}</div>
            <div class="gender-catalog">{{s.пол}}</div>
            <div class="product-details">
                <div class="all-data categories">{{s.категория}}</div>
                <div class="all-data">модель: {{s.модель}}</div>
            </div>
            <div class="price-info">

                <div class="start-price"><span class="red crossed">

                        {% if s.скидка != 0 or s.промо_скидка != 0 %} {{ "{:,}".format(s.цена) }} {% endif %}
                    </span>
                </div>
                <div class="final-price">цена: {{ "{:,}".format((s.цена * (1-s.скидка)*(1 - s.промо_скидка))|int) }}
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- this one is added by ChatGPT-4 -->
<!-- Adds a lazy load handler to images with the "lazy" class. Checks if the IntersectionObserver API is supported, and
if so, uses it to only load images when they become visible in the viewport. Falls back to a less performant method if
IntersectionObserver
is not supported. -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var lazyImages = [].slice.call(document.querySelectorAll("img.lazy"));

        if ("IntersectionObserver" in window) {
            let lazyImageObserver = new IntersectionObserver(function (entries, observer) {
                entries.forEach(function (entry) {
                    if (entry.isIntersecting) {
                        let lazyImage = entry.target;
                        lazyImage.src = lazyImage.dataset.src;
                        lazyImage.classList.remove("lazy");
                        lazyImageObserver.unobserve(lazyImage);
                    }
                });
            });

            lazyImages.forEach(function (lazyImage) {
                lazyImageObserver.observe(lazyImage);
            });
        } else {
            // Possibly fall back to a more compatible method here
        }
    });
</script>



<script src="/static/js/catalog.js"></script>
{% endblock %}